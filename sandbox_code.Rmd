---
title: "Code Sandbox"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)
library(dummies)
```

```{r, include=FALSE}
# Import Data

# Choose whether to force reprocessing of data
reprocess = TRUE

if (file.exists("./data/boston_data.csv") && !reprocess) {
  # Read in existing data from file
  boston.data <- read.csv("./data/boston_data.csv", sep = ",", header=TRUE, na.strings=c("", " ", "NA"))
  
} else {
  # Read in full dataset
  full.data <- read.csv("./data/listings.csv", sep = ",", header=TRUE, na.strings=c("", " ", "NA"))
  
  # Select features to keep
  features_to_keep <- c("host_is_superhost", "host_identity_verified", "zipcode", "property_type", "room_type", "accommodates", "bathrooms", "bedrooms", "beds", "bed_type", "price", "guests_included", "minimum_nights", "number_of_reviews", "instant_bookable", "is_business_travel_ready", "cancellation_policy")
  boston.data.raw <- full.data[ , features_to_keep, drop=FALSE]
  
  # Omit NA values
  boston.data <- na.omit(boston.data.raw)
  
  # Correct feature datatypes
  ## Remove categorical columns to be re-added
  categorical <- c("host_is_superhost", "host_identity_verified", "zipcode", "property_type", "room_type", "bed_type", "instant_bookable", "is_business_travel_ready", "cancellation_policy")
  boston <- boston.data %>% select(-one_of(categorical))
  
  ## host_is_superhost
  boston <- cbind(boston, host_is_superhost=dummy(boston.data$host_is_superhost, sep="_")[ , -1])
  
  ## host_identity_verified
  boston <- cbind(boston, host_identity_verified=dummy(boston.data$host_identity_verified, sep="_")[ , -1])
  
  ## instant_bookable
  boston <- cbind(boston, instant_bookable=dummy(boston.data$instant_bookable, sep="_")[ , -1])
  
  ## is_business_travel_ready
  boston <- cbind(boston, is_business_travel_ready=dummy(boston.data$is_business_travel_ready, sep="_")[ , -1])
  
  ## zipcode
  temp <- data.frame(dummy(boston.data$zipcode))[ , -1]
  boston <- cbind(boston, temp)
  
  ## property_type
  temp <- data.frame(dummy(boston.data$property_type))[ , -1]
  boston <- cbind(boston, temp)
  
  ## room_type
  temp <- data.frame(dummy(boston.data$room_type))[ , -1]
  boston <- cbind(boston, temp)
  
  ## bed_type
  temp <- data.frame(dummy(boston.data$bed_type))[ , -1]
  boston <- cbind(boston, temp)
  
  ## cancellation_policy
  temp <- data.frame(dummy(boston.data$cancellation_policy))[ , -1]
  boston <- cbind(boston, temp)
  
  ## price
  boston$price <- as.numeric(gsub(",", "", substr(boston$price, 2, length(boston$price) - 1)))
  
  # Save data
  write.csv(boston, file = "./data/boston_data.csv")
}
```



### Price distribution
```{r}
class(boston$price)
p <- ggplot(data = boston, aes(boston$zipcode, boston$price, ylab="hey"))
p + geom_bar(stat = "identity")
```

## Split training and validation data
```{r}
ratio <- sample(1:nrow(boston), 0.7*nrow(boston))
boston_training <- boston[ratio, ]
boston_validation <- boston[-ratio, ]
```











