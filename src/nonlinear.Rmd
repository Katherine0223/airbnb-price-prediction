---
title: "Nonlinear Models"
author: "Nakul Camasamudram"
date: "11/18/2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Generalized Additive Models
===============================

```{r}
require(ISLR)
attach(Wage)

# Imports
library(mgcv)
```

## Load Data

```{r}
## Read data

boston.dboth <- read.csv("./data/boston_dboth.csv", sep = ",", header=TRUE, na.strings=c("", " ", "NA"))
boston.dairport <- read.csv("./data/boston_dairport.csv", sep = ",", header=TRUE, na.strings=c("", " ", "NA"))
boston.ddowntown <- read.csv("./data/boston_ddowntown.csv", sep = ",", header=TRUE, na.strings=c("", " ", "NA"))
```

```{r}
# Split into train and test data
ratio <- sample(1:nrow(boston.dboth), 0.7*nrow(boston.dboth))
boston.dboth.train <- boston.dboth[ratio, ]
boston.dboth.test <- boston.dboth[-ratio, ]
```

## Build Models

```{r}
## Model 1
gam_1 <- gam(price ~ s(ddowntown), data=boston.dboth.train)
summary(gam_1)
plot(gam_1, shade = TRUE)
```

```{r}
## Model 2
gam_2 <- gam(price ~ s(ddowntown), data=boston.dboth.train)
summary(gam_1)
plot(gam_1, shade = TRUE)
```

```{r}
## Model 3
gam_3 <- gam(price ~ s(ddowntown), data=boston.dboth.train)
summary(gam_1)
plot(gam_1, shade = TRUE)
```

## Evaluate Models
```{r}
anova(gam_1, gam_2, gam_3)
```